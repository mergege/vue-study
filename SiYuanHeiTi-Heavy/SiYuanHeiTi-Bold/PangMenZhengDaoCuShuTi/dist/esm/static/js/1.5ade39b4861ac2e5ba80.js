webpackJsonp([1],{"2xjc":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("L1vg"),s=a("T2Wy"),r={components:{PVItem:i.a},data:function(){return{base:"",productList:[],detail:{},list:[],searchData:{pageSize:10},isLoading:!1,allLoad:!1}},created:function(){this.base=sessionStorage.getItem("esm_wxShareUrl")||location.origin,this.productList=JSON.parse(sessionStorage.getItem("productList")),this.productList=this.productList.filter(function(t){return"0"===t.productCategoryColumn}),this.init()},beforeRouteLeave:function(t,e,a){window.removeEventListener("scroll",this.onScroll),a()},watch:{$route:function(t,e){"visitorPV"!==t.name&&"productPV"!==t.name||this.init()}},filters:{getTime:function(t){if(/^[0-9]*$/.test(t)){var e=parseInt(t);return Object(s.a)("yyyy-MM-dd hh:mm:ss",e)}return t}},methods:{init:function(){this.detail=JSON.parse(this.$route.query.detail),this.list=[],this.isLoading=!1,this.allLoad=!1,this.searchData.empNo=this.detail.empNo,this.searchData.pageNum=1,"product"===this.detail.type?(this.detail.total=0,this.searchData.productId=this.detail.productId,this.searchData.userId=null):(this.searchData.userId=this.detail.userId,this.searchData.productId=null,this.searchData.visitTime="store"===this.detail.from?new Date(this.detail.start.replace(/-/g,"/")).getTime():0),this.getList(),window.addEventListener("scroll",this.onScroll)},getList:function(){"product"===this.detail.type?this.getListbyProduct():this.getListbyVisitor()},getListbyProduct:function(){var t=this;this.$touch({url:"/api/v1/business/productRecord",method:"get",data:this.searchData}).then(function(e){"Y"===e.code?(e.body.map(function(e){e.interval=t.getTime(e.start,e.endTime||e.end),e.empNo=t.detail.empNo,e.hasArrow=!0,e.type="visitor",t.list.push(e)}),t.detail.total+=e.body.length):(t.searchData.pageNum--,t.$Message.error("服务器错误")),t.isLoading=!1,t.allLoad=t.searchData.pageNum>1&&e.body.length<t.searchData.pageSize})},getListbyVisitor:function(){var t=this;this.$touch({url:"/api/v1/business/visitorRecord",method:"get",data:this.searchData}).then(function(e){if("Y"===e.code){var a={};e.body.map(function(e){a=t.productList.find(function(t){return t.productCode===e.productId}),t.list.push({empNo:t.empNo,img:t.base+"/RH_MSPSERVER/wechat/productImage/"+a.productCode+"-display.jpg",name:a.productFullName,start:e.start,interval:t.getTime(e.start,e.endTime||e.end),hasArrow:!1,type:"product"})})}else t.searchData.pageNum--,t.$Message.error("服务器错误");t.allLoad=t.searchData.pageNum>1&&e.body.length<t.searchData.pageSize,t.isLoading=!1})},getTime:function(t,e){if(!e||!t)return"-";var a=t?parseInt(t):0,i=(((e?parseInt(e):0)-a)/1e3).toFixed(1),s=parseInt(i/3600),r=parseInt(i%3600/60),o=parseInt(i%60);return(s=s>10?s:("0"+s).substr(-2))+":"+("0"+r).substr(-2)+":"+("0"+o).substr(-2)},onScroll:function(){var t=document.body.scrollTop||document.documentElement.scrollTop,e=document.body.scrollHeight||document.documentElement.scrollHeight;t+(document.body.clientHeight||document.documentElement.clientHeight||window.innerHeight)>=e-10&&!this.isLoading&&!this.allLoad&&(this.searchData.pageNum++,this.isLoading=!0,this.getList())}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page"},[i("header",[i("img",{class:"product"===t.detail.type?"img":"avatar",attrs:{src:"product"===t.detail.type?t.detail.img:t.detail.avatar,alt:"avatar"}}),t._v(" "),i("div",{staticClass:"detail-wrapper"},[i("p",{staticClass:"name"},[t._v(t._s("product"===t.detail.type?t.detail.name:t.detail.userName))]),t._v(" "),"product"===t.detail.type?i("p",[t._v("累计"+t._s(t.detail.total)+"人访问过")]):t._e(),t._v(" "),"visitor"===t.detail.type?i("p",[t._v(t._s("store"===t.detail.from?"本次访问店铺时间：":"本次浏览产品时间：")+t._s(t._f("getTime")(t.detail.start)))]):t._e()])]),t._v(" "),t.list.length>0?i("div",{staticClass:"content"},t._l(t.list,function(t,e){return i("PVItem",{key:e,attrs:{detail:t}})})):i("img",{staticClass:"empty",attrs:{src:a("lDQN"),alt:"empty"}}),t._v(" "),t.isLoading?i("div",{staticClass:"bottom"},[i("span",{staticClass:"isLoading"},[t._v(" 加载中... ")])]):t._e(),t._v(" "),t.allLoad&&t.list.length>0?i("div",{staticClass:"bottom"},[i("span",{staticClass:"allLoad"},[t._v("我是有底线的")])]):t._e()])},staticRenderFns:[]};var n=a("VU/8")(r,o,!1,function(t){a("ZAOw")},"data-v-e34b4af6",null);e.default=n.exports},"83WB":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAkCAYAAABmMXGeAAAAAXNSR0IArs4c6QAAAn9JREFUSA2tlvtOE0EUxtuVVzJtn0ONFxS1Bu+AikHFyx+KiBBQhIBGDFZEjC/SyzvZ+jvNfJvpdLbdbtyk+facnfmd78xM2y2V3NVut2/x2ev1emXliuqUTWy1WjeB7Ruw0+mU0HvlcrlXFJo0m81ZJn+Ww263ewfHu0WBNi/B0WkBBSK+i/vC4LIBcXaA1gX1dKdWq817ca5bc9qrVCqz6GFkxhyOtyP5kal0p3Ga4Pgbei2cQcHtarX6IMxnxYkeMLGL4xvEDeWkFFpgQ7cUj9MUagMNjKM6ehSZ+JBONiP5oVTavv/ELUUDvezn7Z6CmxR+HOb9eMCpHriluEp8rJyUQots3obimEadaiCAUwB+EF9SztN1jtsTL05vo071FMd/aXUGPVHO0yXWeM2L09uRTjXKHAP4iV5QTkrBNQo/U2yaC2oDHfgYPW9xcK2yFM+VG9m+BpnaUnCO7TT88fPufplOVpTP7VQTcDoF4AQ9q5yUwissxcuJoQZw4N/oGQGlgF/nbl+T8ujETse0/4b2X00EdcBf6LnQcZIkb9nIF5bP3T4gndUhIJxVAQ2ay6kHjB3+d7S8bDBdY6EOeIRe1CQpLb/H4VPF0v5ftIJQDeh+UIaAjF2PAY2R6RRg4oDTYTHO4gYtL4V5xdGNMiDfmgaDYkD7kc4EGnjIqQN+R6+ospQ13KLlRcVZOuDUAQ9jQAAf8gCtULpRDmh/0TOhA9bwIy0/CvNZcb99B7S3lOvhQICfAC6E+VFxAshee77GgEzcmRRoxWyXvwCsRyrvFnmP6kNpr8Nn4F2UeA/gXKRQrlTCjh4w8rbAHJt9cvdzzR43iGX4b6/n/wCFTUue9qN1SwAAAABJRU5ErkJggg=="},L1vg:function(t,e,a){"use strict";var i=a("mvHQ"),s=a.n(i),r=a("T2Wy"),o={name:"PVItem",props:{detail:{type:Object,default:function(){return{}}}},filters:{getTime:function(t){var e=parseInt(t);return Object(r.a)("yyyy-MM-dd hh:mm:ss",e)}},methods:{changeRouter:function(){switch(this.$route.path){case"/pageview":console.log(this.detail),"product"===this.detail.type?this.$router.push({name:"productPV",query:{detail:s()(this.detail)}}):"visitor"===this.detail.type&&this.detail.hasArrow&&this.$router.push({name:"visitorPV",query:{detail:s()(this.detail)}});break;case"/productPV":this.$router.push({name:"visitorPV",query:{detail:s()(this.detail)}})}}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item-wrapper",on:{click:t.changeRouter}},["visitor"===t.detail.type?[i("img",{staticClass:"avatar",attrs:{src:t.detail.avatar,alt:"avatar"}}),t._v(" "),i("div",{staticClass:"detail-wrapper"},[i("p",{staticClass:"name"},[t._v(t._s(t.detail.userName))]),t._v(" "),t.detail.interval?i("p",[t._v(t._s(t._f("getTime")(t.detail.start))+" 访问时长："+t._s(t.detail.interval))]):i("p",[t._v(t._s(t.detail.visitTime))])])]:t._e(),t._v(" "),"product"===t.detail.type?[i("img",{staticClass:"img",attrs:{src:t.detail.img,alt:"product"}}),t._v(" "),i("div",{staticClass:"detail-wrapper"},[i("p",{staticClass:"name"},[t._v(t._s(t.detail.name))]),t._v(" "),t.detail.interval?i("p",[t._v(t._s(t._f("getTime")(t.detail.start))+" 访问时长："+t._s(t.detail.interval))]):i("p",[t._v("累计"+t._s(t.detail.total)+"人访问过")])])]:t._e(),t._v(" "),t.detail.hasArrow?i("img",{staticClass:"arrow",attrs:{src:a("83WB"),alt:"arrow"}}):t._e()],2)},staticRenderFns:[]};var l=a("VU/8")(o,n,!1,function(t){a("vnob")},"data-v-76b9b7af",null);e.a=l.exports},T2Wy:function(t,e,a){"use strict";e.a=function(t,e){var a=new Date(e),i={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var s in i)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,("00"+i[s]).substr(-2,2)));return t}},ZAOw:function(t,e){},lDQN:function(t,e,a){t.exports=a.p+"static/img/empty.c93938a.png"},vnob:function(t,e){}});
//# sourceMappingURL=1.5ade39b4861ac2e5ba80.js.map